{"version":3,"sources":["index.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar _extends = require('@babel/runtime/helpers/esm/extends');\nvar _objectSpread = require('@babel/runtime/helpers/objectSpread2');\nvar _asyncToGenerator = require('@babel/runtime/helpers/asyncToGenerator');\nvar _regeneratorRuntime = require('@babel/runtime/regenerator');\nvar _toConsumableArray = require('@babel/runtime/helpers/toConsumableArray');\nvar _classCallCheck = require('@babel/runtime/helpers/classCallCheck');\nvar _createClass = require('@babel/runtime/helpers/createClass');\nvar _defineProperty = require('@babel/runtime/helpers/defineProperty');\nvar runtime = require('@tarojs/runtime');\nvar _typeof = require('@babel/runtime/helpers/typeof');\nvar _slicedToArray = require('@babel/runtime/helpers/slicedToArray');\nvar _createForOfIteratorHelper = require('@babel/runtime/helpers/createForOfIteratorHelper');\nvar taro = require('@tarojs/taro');\n\nfunction _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }\n\nvar _extends__default = /*#__PURE__*/_interopDefaultLegacy(_extends);\nvar _objectSpread__default = /*#__PURE__*/_interopDefaultLegacy(_objectSpread);\nvar _asyncToGenerator__default = /*#__PURE__*/_interopDefaultLegacy(_asyncToGenerator);\nvar _regeneratorRuntime__default = /*#__PURE__*/_interopDefaultLegacy(_regeneratorRuntime);\nvar _toConsumableArray__default = /*#__PURE__*/_interopDefaultLegacy(_toConsumableArray);\nvar _classCallCheck__default = /*#__PURE__*/_interopDefaultLegacy(_classCallCheck);\nvar _createClass__default = /*#__PURE__*/_interopDefaultLegacy(_createClass);\nvar _defineProperty__default = /*#__PURE__*/_interopDefaultLegacy(_defineProperty);\nvar _typeof__default = /*#__PURE__*/_interopDefaultLegacy(_typeof);\nvar _slicedToArray__default = /*#__PURE__*/_interopDefaultLegacy(_slicedToArray);\nvar _createForOfIteratorHelper__default = /*#__PURE__*/_interopDefaultLegacy(_createForOfIteratorHelper);\n\nvar r,\n    B = r || (r = {});\nB.Pop = \"POP\";\nB.Push = \"PUSH\";\nB.Replace = \"REPLACE\";\nvar C = \"production\" !== process.env.NODE_ENV ? function (b) {\n  return Object.freeze(b);\n} : function (b) {\n  return b;\n};\n\nfunction D(b, h) {\n  if (!b) {\n    \"undefined\" !== typeof console && console.warn(h);\n\n    try {\n      throw Error(h);\n    } catch (k) {}\n  }\n}\n\nfunction E(b) {\n  b.preventDefault();\n  b.returnValue = \"\";\n}\n\nfunction F() {\n  var b = [];\n  return {\n    get length() {\n      return b.length;\n    },\n\n    push: function push(h) {\n      b.push(h);\n      return function () {\n        b = b.filter(function (k) {\n          return k !== h;\n        });\n      };\n    },\n    call: function call(h) {\n      b.forEach(function (k) {\n        return k && k(h);\n      });\n    }\n  };\n}\n\nfunction H() {\n  return Math.random().toString(36).substr(2, 8);\n}\n\nfunction I(b) {\n  var h = b.pathname,\n      k = b.search;\n  b = b.hash;\n  return (void 0 === h ? \"/\" : h) + (void 0 === k ? \"\" : k) + (void 0 === b ? \"\" : b);\n}\n\nfunction J(b) {\n  var h = {};\n\n  if (b) {\n    var k = b.indexOf(\"#\");\n    0 <= k && (h.hash = b.substr(k), b = b.substr(0, k));\n    k = b.indexOf(\"?\");\n    0 <= k && (h.search = b.substr(k), b = b.substr(0, k));\n    b && (h.pathname = b);\n  }\n\n  return h;\n}\n\nfunction createBrowserHistory(b) {\n  function h() {\n    var c = p.location,\n        a = m.state || {};\n    return [a.idx, C({\n      pathname: c.pathname,\n      search: c.search,\n      hash: c.hash,\n      state: a.usr || null,\n      key: a.key || \"default\"\n    })];\n  }\n\n  function k(c) {\n    return \"string\" === typeof c ? c : I(c);\n  }\n\n  function x(c, a) {\n    void 0 === a && (a = null);\n    return C(_extends__default['default']({\n      pathname: q.pathname,\n      hash: \"\",\n      search: \"\"\n    }, \"string\" === typeof c ? J(c) : c, {\n      state: a,\n      key: H()\n    }));\n  }\n\n  function z(c) {\n    t = c;\n    c = h();\n    v = c[0];\n    q = c[1];\n    d.call({\n      action: t,\n      location: q\n    });\n  }\n\n  function A(c, a) {\n    function e() {\n      A(c, a);\n    }\n\n    var l = r.Push,\n        g = x(c, a);\n\n    if (!f.length || (f.call({\n      action: l,\n      location: g,\n      retry: e\n    }), !1)) {\n      var n = [{\n        usr: g.state,\n        key: g.key,\n        idx: v + 1\n      }, k(g)];\n      g = n[0];\n      n = n[1];\n\n      try {\n        m.pushState(g, \"\", n);\n      } catch (G) {\n        p.location.assign(n);\n      }\n\n      z(l);\n    }\n  }\n\n  function y(c, a) {\n    function e() {\n      y(c, a);\n    }\n\n    var l = r.Replace,\n        g = x(c, a);\n    f.length && (f.call({\n      action: l,\n      location: g,\n      retry: e\n    }), 1) || (g = [{\n      usr: g.state,\n      key: g.key,\n      idx: v\n    }, k(g)], m.replaceState(g[0], \"\", g[1]), z(l));\n  }\n\n  function w(c) {\n    m.go(c);\n  }\n\n  void 0 === b && (b = {});\n  b = b.window;\n  var p = void 0 === b ? document.defaultView : b,\n      m = p.history,\n      u = null;\n  p.addEventListener(\"popstate\", function () {\n    if (u) f.call(u), u = null;else {\n      var c = r.Pop,\n          a = h(),\n          e = a[0];\n      a = a[1];\n      if (f.length) {\n        if (null != e) {\n          var l = v - e;\n          l && (u = {\n            action: c,\n            location: a,\n            retry: function retry() {\n              w(-1 * l);\n            }\n          }, w(l));\n        } else \"production\" !== process.env.NODE_ENV ? D(!1, \"You are trying to block a POP navigation to a location that was not created by the history library. The block will fail silently in production, but in general you should do all navigation with the history library (instead of using window.history.pushState directly) to avoid this situation.\") : void 0;\n      } else z(c);\n    }\n  });\n  var t = r.Pop;\n  b = h();\n  var v = b[0],\n      q = b[1],\n      d = F(),\n      f = F();\n  null == v && (v = 0, m.replaceState(_extends__default['default']({}, m.state, {\n    idx: v\n  }), \"\"));\n  return {\n    get action() {\n      return t;\n    },\n\n    get location() {\n      return q;\n    },\n\n    createHref: k,\n    push: A,\n    replace: y,\n    go: w,\n    back: function back() {\n      w(-1);\n    },\n    forward: function forward() {\n      w(1);\n    },\n    listen: function listen(c) {\n      return d.push(c);\n    },\n    block: function block(c) {\n      var a = f.push(c);\n      1 === f.length && p.addEventListener(\"beforeunload\", E);\n      return function () {\n        a();\n        f.length || p.removeEventListener(\"beforeunload\", E);\n      };\n    }\n  };\n}\n\nfunction createHashHistory(b) {\n  function h() {\n    var a = J(m.location.hash.substr(1)),\n        e = a.pathname,\n        l = a.search;\n    a = a.hash;\n    var g = u.state || {};\n    return [g.idx, C({\n      pathname: void 0 === e ? \"/\" : e,\n      search: void 0 === l ? \"\" : l,\n      hash: void 0 === a ? \"\" : a,\n      state: g.usr || null,\n      key: g.key || \"default\"\n    })];\n  }\n\n  function k() {\n    if (t) c.call(t), t = null;else {\n      var a = r.Pop,\n          e = h(),\n          l = e[0];\n      e = e[1];\n      if (c.length) {\n        if (null != l) {\n          var g = q - l;\n          g && (t = {\n            action: a,\n            location: e,\n            retry: function retry() {\n              p(-1 * g);\n            }\n          }, p(g));\n        } else \"production\" !== process.env.NODE_ENV ? D(!1, \"You are trying to block a POP navigation to a location that was not created by the history library. The block will fail silently in production, but in general you should do all navigation with the history library (instead of using window.history.pushState directly) to avoid this situation.\") : void 0;\n      } else A(a);\n    }\n  }\n\n  function x(a) {\n    var e = document.querySelector(\"base\"),\n        l = \"\";\n    e && e.getAttribute(\"href\") && (e = m.location.href, l = e.indexOf(\"#\"), l = -1 === l ? e : e.slice(0, l));\n    return l + \"#\" + (\"string\" === typeof a ? a : I(a));\n  }\n\n  function z(a, e) {\n    void 0 === e && (e = null);\n    return C(_extends__default['default']({\n      pathname: d.pathname,\n      hash: \"\",\n      search: \"\"\n    }, \"string\" === typeof a ? J(a) : a, {\n      state: e,\n      key: H()\n    }));\n  }\n\n  function A(a) {\n    v = a;\n    a = h();\n    q = a[0];\n    d = a[1];\n    f.call({\n      action: v,\n      location: d\n    });\n  }\n\n  function y(a, e) {\n    function l() {\n      y(a, e);\n    }\n\n    var g = r.Push,\n        n = z(a, e);\n    \"production\" !== process.env.NODE_ENV ? D(\"/\" === n.pathname.charAt(0), \"Relative pathnames are not supported in hash history.push(\" + JSON.stringify(a) + \")\") : void 0;\n\n    if (!c.length || (c.call({\n      action: g,\n      location: n,\n      retry: l\n    }), !1)) {\n      var G = [{\n        usr: n.state,\n        key: n.key,\n        idx: q + 1\n      }, x(n)];\n      n = G[0];\n      G = G[1];\n\n      try {\n        u.pushState(n, \"\", G);\n      } catch (K) {\n        m.location.assign(G);\n      }\n\n      A(g);\n    }\n  }\n\n  function w(a, e) {\n    function l() {\n      w(a, e);\n    }\n\n    var g = r.Replace,\n        n = z(a, e);\n    \"production\" !== process.env.NODE_ENV ? D(\"/\" === n.pathname.charAt(0), \"Relative pathnames are not supported in hash history.replace(\" + JSON.stringify(a) + \")\") : void 0;\n    c.length && (c.call({\n      action: g,\n      location: n,\n      retry: l\n    }), 1) || (n = [{\n      usr: n.state,\n      key: n.key,\n      idx: q\n    }, x(n)], u.replaceState(n[0], \"\", n[1]), A(g));\n  }\n\n  function p(a) {\n    u.go(a);\n  }\n\n  void 0 === b && (b = {});\n  b = b.window;\n  var m = void 0 === b ? document.defaultView : b,\n      u = m.history,\n      t = null;\n  m.addEventListener(\"popstate\", k);\n  m.addEventListener(\"hashchange\", function () {\n    var a = h()[1];\n    I(a) !== I(d) && k();\n  });\n  var v = r.Pop;\n  b = h();\n  var q = b[0],\n      d = b[1],\n      f = F(),\n      c = F();\n  null == q && (q = 0, u.replaceState(_extends__default['default']({}, u.state, {\n    idx: q\n  }), \"\"));\n  return {\n    get action() {\n      return v;\n    },\n\n    get location() {\n      return d;\n    },\n\n    createHref: x,\n    push: y,\n    replace: w,\n    go: p,\n    back: function back() {\n      p(-1);\n    },\n    forward: function forward() {\n      p(1);\n    },\n    listen: function listen(a) {\n      return f.push(a);\n    },\n    block: function block(a) {\n      var e = c.push(a);\n      1 === c.length && m.addEventListener(\"beforeunload\", E);\n      return function () {\n        e();\n        c.length || m.removeEventListener(\"beforeunload\", E);\n      };\n    }\n  };\n}\n\nexports.history = void 0;\nvar basename = '/';\nfunction setHistoryMode(mode) {\n  var base = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '/';\n  var options = {\n    window: window\n  };\n  basename = base;\n\n  if (mode === 'browser') {\n    exports.history = createBrowserHistory(options);\n  } else {\n    // default is hash\n    exports.history = createHashHistory(options);\n  }\n}\nfunction prependBasename() {\n  var url = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  return basename.replace(/\\/$/, '') + '/' + url.replace(/^\\//, '');\n}\nvar hasBasename = function hasBasename() {\n  var path = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  var prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n  return new RegExp('^' + prefix + '(\\\\/|\\\\?|#|$)', 'i').test(path);\n};\nvar stripBasename = function stripBasename() {\n  var path = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  var prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n  return hasBasename(path, prefix) ? path.substr(prefix.length) : path;\n};\n\nvar Stacks = /*#__PURE__*/function () {\n  function Stacks() {\n    _classCallCheck__default['default'](this, Stacks);\n\n    _defineProperty__default['default'](this, \"stacks\", []);\n\n    _defineProperty__default['default'](this, \"backDelta\", 0);\n  }\n\n  _createClass__default['default'](Stacks, [{\n    key: \"delta\",\n    set: function set(delta) {\n      if (delta > 0) {\n        this.backDelta = delta;\n      } else if (this.backDelta > 0) {\n        --this.backDelta;\n      } else {\n        this.backDelta = 0;\n      }\n    }\n  }, {\n    key: \"length\",\n    get: function get() {\n      return this.stacks.length;\n    }\n  }, {\n    key: \"last\",\n    get: function get() {\n      return this.stacks[this.length - 1];\n    }\n  }, {\n    key: \"get\",\n    value: function get() {\n      return this.stacks;\n    }\n  }, {\n    key: \"getItem\",\n    value: function getItem(index) {\n      return this.stacks[index];\n    }\n  }, {\n    key: \"getLastIndex\",\n    value: function getLastIndex(pathname) {\n      var stateWith = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n\n      var list = _toConsumableArray__default['default'](this.stacks).reverse();\n\n      return list.findIndex(function (page, i) {\n        var _page$path;\n\n        return i >= stateWith && ((_page$path = page.path) === null || _page$path === void 0 ? void 0 : _page$path.replace(/\\?.*/g, '')) === pathname;\n      });\n    }\n  }, {\n    key: \"getDelta\",\n    value: function getDelta(pathname) {\n      if (this.backDelta >= 1) {\n        return this.backDelta;\n      }\n\n      var index = this.getLastIndex(pathname); // NOTE: 此处为了修复浏览器后退多级页面，在大量重复路由状况下可能出现判断错误的情况 （增强判断能力只能考虑在 query 中新增参数来判断，暂时搁置）\n\n      return index > 0 ? index : 1;\n    }\n  }, {\n    key: \"getPrevIndex\",\n    value: function getPrevIndex(pathname) {\n      var stateWith = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n      var lastIndex = this.getLastIndex(pathname, stateWith);\n\n      if (lastIndex < 0) {\n        return -1;\n      }\n\n      return this.length - 1 - lastIndex;\n    }\n  }, {\n    key: \"pop\",\n    value: function pop() {\n      return this.stacks.pop();\n    }\n  }, {\n    key: \"push\",\n    value: function push(page) {\n      return this.stacks.push(page);\n    }\n  }]);\n\n  return Stacks;\n}();\n\nvar stacks = new Stacks();\n\nfunction addLeadingSlash(path) {\n  if (path == null) {\n    return '';\n  }\n\n  return path.charAt(0) === '/' ? path : '/' + path;\n}\n\nvar RoutesAlias = /*#__PURE__*/function () {\n  function RoutesAlias() {\n    var _this = this;\n\n    _classCallCheck__default['default'](this, RoutesAlias);\n\n    _defineProperty__default['default'](this, \"conf\", []);\n\n    _defineProperty__default['default'](this, \"getConfig\", function () {\n      var url = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n\n      var customRoute = _this.conf.filter(function (arr) {\n        return arr.includes(url);\n      });\n\n      return customRoute[0];\n    });\n\n    _defineProperty__default['default'](this, \"getOrigin\", function () {\n      var _this$getConfig;\n\n      var url = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n      return ((_this$getConfig = _this.getConfig(url)) === null || _this$getConfig === void 0 ? void 0 : _this$getConfig[0]) || url;\n    });\n\n    _defineProperty__default['default'](this, \"getAlias\", function () {\n      var _this$getConfig2;\n\n      var url = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n      return ((_this$getConfig2 = _this.getConfig(url)) === null || _this$getConfig2 === void 0 ? void 0 : _this$getConfig2[1]) || url;\n    });\n\n    _defineProperty__default['default'](this, \"getAll\", function () {\n      var url = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n      return _this.conf.filter(function (arr) {\n        return arr.includes(url);\n      }).reduceRight(function (p, a) {\n        p.unshift(a[1]);\n        return p;\n      }, [url]);\n    });\n  }\n\n  _createClass__default['default'](RoutesAlias, [{\n    key: \"set\",\n    value: function set() {\n      var _this2 = this;\n\n      var customRoutes = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      var _loop = function _loop(_key) {\n        var path = customRoutes[_key];\n        _key = addLeadingSlash(_key);\n\n        if (typeof path === 'string') {\n          _this2.conf.push([_key, addLeadingSlash(path)]);\n        } else if ((path === null || path === void 0 ? void 0 : path.length) > 0) {\n          var _this2$conf;\n\n          (_this2$conf = _this2.conf).push.apply(_this2$conf, _toConsumableArray__default['default'](path.map(function (p) {\n            return [_key, addLeadingSlash(p)];\n          })));\n        }\n\n        key = _key;\n      };\n\n      for (var key in customRoutes) {\n        _loop(key);\n      }\n    }\n  }]);\n\n  return RoutesAlias;\n}();\n\nvar routesAlias = new RoutesAlias();\n\nfunction processNavigateUrl(option) {\n  var _pathPieces$pathname;\n\n  var pathPieces = J(option.url); // 处理相对路径\n\n  if ((_pathPieces$pathname = pathPieces.pathname) !== null && _pathPieces$pathname !== void 0 && _pathPieces$pathname.includes('./')) {\n    var parts = routesAlias.getOrigin(exports.history.location.pathname).split('/');\n    parts.pop();\n    pathPieces.pathname.split('/').forEach(function (item) {\n      if (item === '.') {\n        return;\n      }\n\n      item === '..' ? parts.pop() : parts.push(item);\n    });\n    pathPieces.pathname = parts.join('/');\n  } // 处理自定义路由\n\n\n  pathPieces.pathname = routesAlias.getAlias(addLeadingSlash(pathPieces.pathname)); // 处理 basename\n\n  pathPieces.pathname = prependBasename(pathPieces.pathname); // hack fix history v5 bug: https://github.com/remix-run/history/issues/814\n\n  if (!pathPieces.search) pathPieces.search = '';\n  return pathPieces;\n}\n\nfunction navigate(_x, _x2) {\n  return _navigate.apply(this, arguments);\n}\n\nfunction _navigate() {\n  _navigate = _asyncToGenerator__default['default']( /*#__PURE__*/_regeneratorRuntime__default['default'].mark(function _callee(option, method) {\n    return _regeneratorRuntime__default['default'].wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            return _context.abrupt(\"return\", new Promise(function (resolve, reject) {\n              var success = option.success,\n                  complete = option.complete,\n                  fail = option.fail;\n              var unListen = exports.history.listen(function () {\n                var res = {\n                  errMsg: \"\".concat(method, \":ok\")\n                };\n                success === null || success === void 0 ? void 0 : success(res);\n                complete === null || complete === void 0 ? void 0 : complete(res);\n                resolve(res);\n                unListen();\n              });\n\n              try {\n                if ('url' in option) {\n                  var pathPieces = processNavigateUrl(option);\n                  var state = {\n                    timestamp: Date.now()\n                  };\n\n                  if (method === 'navigateTo') {\n                    exports.history.push(pathPieces, state);\n                  } else if (method === 'redirectTo' || method === 'switchTab') {\n                    exports.history.replace(pathPieces, state);\n                  } else if (method === 'reLaunch') {\n                    stacks.delta = stacks.length;\n                    exports.history.replace(pathPieces, state);\n                  }\n                } else if (method === 'navigateBack') {\n                  stacks.delta = option.delta;\n                  exports.history.go(-option.delta);\n                }\n              } catch (error) {\n                var res = {\n                  errMsg: \"\".concat(method, \":fail \").concat(error.message || error)\n                };\n                fail === null || fail === void 0 ? void 0 : fail(res);\n                complete === null || complete === void 0 ? void 0 : complete(res);\n                reject(res);\n              }\n            }));\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _navigate.apply(this, arguments);\n}\n\nfunction navigateTo(option) {\n  return navigate(option, 'navigateTo');\n}\nfunction redirectTo(option) {\n  return navigate(option, 'redirectTo');\n}\nfunction navigateBack() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n    delta: 1\n  };\n\n  if (!options.delta || options.delta < 1) {\n    options.delta = 1;\n  }\n\n  return navigate(options, 'navigateBack');\n}\nfunction switchTab(option) {\n  return navigate(option, 'switchTab');\n}\nfunction reLaunch(option) {\n  return navigate(option, 'reLaunch');\n}\nfunction getCurrentPages() {\n  var pages = stacks.get();\n  return pages.map(function (e) {\n    return _objectSpread__default['default'](_objectSpread__default['default']({}, e), {}, {\n      route: e.path || ''\n    });\n  });\n}\n\nvar pathToRegexp$2 = {exports: {}};\n\npathToRegexp$2.exports = pathToRegexp;\npathToRegexp$2.exports.match = match;\npathToRegexp$2.exports.regexpToFunction = regexpToFunction;\npathToRegexp$2.exports.parse = parse;\npathToRegexp$2.exports.compile = compile;\npathToRegexp$2.exports.tokensToFunction = tokensToFunction;\npathToRegexp$2.exports.tokensToRegExp = tokensToRegExp;\n/**\n * Default configs.\n */\n\nvar DEFAULT_DELIMITER = '/';\n/**\n * The main path matching regexp utility.\n *\n * @type {RegExp}\n */\n\nvar PATH_REGEXP = new RegExp([// Match escaped characters that would otherwise appear in future matches.\n// This allows the user to escape special characters that won't transform.\n'(\\\\\\\\.)', // Match Express-style parameters and un-named parameters with a prefix\n// and optional suffixes. Matches appear as:\n//\n// \":test(\\\\d+)?\" => [\"test\", \"\\d+\", undefined, \"?\"]\n// \"(\\\\d+)\"  => [undefined, undefined, \"\\d+\", undefined]\n'(?:\\\\:(\\\\w+)(?:\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))?|\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))([+*?])?'].join('|'), 'g');\n/**\n * Parse a string for the raw tokens.\n *\n * @param  {string}  str\n * @param  {Object=} options\n * @return {!Array}\n */\n\nfunction parse(str, options) {\n  var tokens = [];\n  var key = 0;\n  var index = 0;\n  var path = '';\n  var defaultDelimiter = options && options.delimiter || DEFAULT_DELIMITER;\n  var whitelist = options && options.whitelist || undefined;\n  var pathEscaped = false;\n  var res;\n\n  while ((res = PATH_REGEXP.exec(str)) !== null) {\n    var m = res[0];\n    var escaped = res[1];\n    var offset = res.index;\n    path += str.slice(index, offset);\n    index = offset + m.length; // Ignore already escaped sequences.\n\n    if (escaped) {\n      path += escaped[1];\n      pathEscaped = true;\n      continue;\n    }\n\n    var prev = '';\n    var name = res[2];\n    var capture = res[3];\n    var group = res[4];\n    var modifier = res[5];\n\n    if (!pathEscaped && path.length) {\n      var k = path.length - 1;\n      var c = path[k];\n      var matches = whitelist ? whitelist.indexOf(c) > -1 : true;\n\n      if (matches) {\n        prev = c;\n        path = path.slice(0, k);\n      }\n    } // Push the current path onto the tokens.\n\n\n    if (path) {\n      tokens.push(path);\n      path = '';\n      pathEscaped = false;\n    }\n\n    var repeat = modifier === '+' || modifier === '*';\n    var optional = modifier === '?' || modifier === '*';\n    var pattern = capture || group;\n    var delimiter = prev || defaultDelimiter;\n    tokens.push({\n      name: name || key++,\n      prefix: prev,\n      delimiter: delimiter,\n      optional: optional,\n      repeat: repeat,\n      pattern: pattern ? escapeGroup(pattern) : '[^' + escapeString(delimiter === defaultDelimiter ? delimiter : delimiter + defaultDelimiter) + ']+?'\n    });\n  } // Push any remaining characters.\n\n\n  if (path || index < str.length) {\n    tokens.push(path + str.substr(index));\n  }\n\n  return tokens;\n}\n/**\n * Compile a string to a template function for the path.\n *\n * @param  {string}             str\n * @param  {Object=}            options\n * @return {!function(Object=, Object=)}\n */\n\n\nfunction compile(str, options) {\n  return tokensToFunction(parse(str, options), options);\n}\n/**\n * Create path match function from `path-to-regexp` spec.\n */\n\n\nfunction match(str, options) {\n  var keys = [];\n  var re = pathToRegexp(str, keys, options);\n  return regexpToFunction(re, keys);\n}\n/**\n * Create a path match function from `path-to-regexp` output.\n */\n\n\nfunction regexpToFunction(re, keys) {\n  return function (pathname, options) {\n    var m = re.exec(pathname);\n    if (!m) return false;\n    var path = m[0];\n    var index = m.index;\n    var params = {};\n    var decode = options && options.decode || decodeURIComponent;\n\n    for (var i = 1; i < m.length; i++) {\n      if (m[i] === undefined) continue;\n      var key = keys[i - 1];\n\n      if (key.repeat) {\n        params[key.name] = m[i].split(key.delimiter).map(function (value) {\n          return decode(value, key);\n        });\n      } else {\n        params[key.name] = decode(m[i], key);\n      }\n    }\n\n    return {\n      path: path,\n      index: index,\n      params: params\n    };\n  };\n}\n/**\n * Expose a method for transforming tokens into the path function.\n */\n\n\nfunction tokensToFunction(tokens, options) {\n  // Compile all the tokens into regexps.\n  var matches = new Array(tokens.length); // Compile all the patterns before compilation.\n\n  for (var i = 0; i < tokens.length; i++) {\n    if (_typeof__default['default'](tokens[i]) === 'object') {\n      matches[i] = new RegExp('^(?:' + tokens[i].pattern + ')$', flags(options));\n    }\n  }\n\n  return function (data, options) {\n    var path = '';\n    var encode = options && options.encode || encodeURIComponent;\n    var validate = options ? options.validate !== false : true;\n\n    for (var i = 0; i < tokens.length; i++) {\n      var token = tokens[i];\n\n      if (typeof token === 'string') {\n        path += token;\n        continue;\n      }\n\n      var value = data ? data[token.name] : undefined;\n      var segment;\n\n      if (Array.isArray(value)) {\n        if (!token.repeat) {\n          throw new TypeError('Expected \"' + token.name + '\" to not repeat, but got array');\n        }\n\n        if (value.length === 0) {\n          if (token.optional) continue;\n          throw new TypeError('Expected \"' + token.name + '\" to not be empty');\n        }\n\n        for (var j = 0; j < value.length; j++) {\n          segment = encode(value[j], token);\n\n          if (validate && !matches[i].test(segment)) {\n            throw new TypeError('Expected all \"' + token.name + '\" to match \"' + token.pattern + '\"');\n          }\n\n          path += (j === 0 ? token.prefix : token.delimiter) + segment;\n        }\n\n        continue;\n      }\n\n      if (typeof value === 'string' || typeof value === 'number' || typeof value === 'boolean') {\n        segment = encode(String(value), token);\n\n        if (validate && !matches[i].test(segment)) {\n          throw new TypeError('Expected \"' + token.name + '\" to match \"' + token.pattern + '\", but got \"' + segment + '\"');\n        }\n\n        path += token.prefix + segment;\n        continue;\n      }\n\n      if (token.optional) continue;\n      throw new TypeError('Expected \"' + token.name + '\" to be ' + (token.repeat ? 'an array' : 'a string'));\n    }\n\n    return path;\n  };\n}\n/**\n * Escape a regular expression string.\n *\n * @param  {string} str\n * @return {string}\n */\n\n\nfunction escapeString(str) {\n  return str.replace(/([.+*?=^!:${}()[\\]|/\\\\])/g, '\\\\$1');\n}\n/**\n * Escape the capturing group by escaping special characters and meaning.\n *\n * @param  {string} group\n * @return {string}\n */\n\n\nfunction escapeGroup(group) {\n  return group.replace(/([=!:$/()])/g, '\\\\$1');\n}\n/**\n * Get the flags for a regexp from the options.\n *\n * @param  {Object} options\n * @return {string}\n */\n\n\nfunction flags(options) {\n  return options && options.sensitive ? '' : 'i';\n}\n/**\n * Pull out keys from a regexp.\n *\n * @param  {!RegExp} path\n * @param  {Array=}  keys\n * @return {!RegExp}\n */\n\n\nfunction regexpToRegexp(path, keys) {\n  if (!keys) return path; // Use a negative lookahead to match only capturing groups.\n\n  var groups = path.source.match(/\\((?!\\?)/g);\n\n  if (groups) {\n    for (var i = 0; i < groups.length; i++) {\n      keys.push({\n        name: i,\n        prefix: null,\n        delimiter: null,\n        optional: false,\n        repeat: false,\n        pattern: null\n      });\n    }\n  }\n\n  return path;\n}\n/**\n * Transform an array into a regexp.\n *\n * @param  {!Array}  path\n * @param  {Array=}  keys\n * @param  {Object=} options\n * @return {!RegExp}\n */\n\n\nfunction arrayToRegexp(path, keys, options) {\n  var parts = [];\n\n  for (var i = 0; i < path.length; i++) {\n    parts.push(pathToRegexp(path[i], keys, options).source);\n  }\n\n  return new RegExp('(?:' + parts.join('|') + ')', flags(options));\n}\n/**\n * Create a path regexp from string input.\n *\n * @param  {string}  path\n * @param  {Array=}  keys\n * @param  {Object=} options\n * @return {!RegExp}\n */\n\n\nfunction stringToRegexp(path, keys, options) {\n  return tokensToRegExp(parse(path, options), keys, options);\n}\n/**\n * Expose a function for taking tokens and returning a RegExp.\n *\n * @param  {!Array}  tokens\n * @param  {Array=}  keys\n * @param  {Object=} options\n * @return {!RegExp}\n */\n\n\nfunction tokensToRegExp(tokens, keys, options) {\n  options = options || {};\n  var strict = options.strict;\n  var start = options.start !== false;\n  var end = options.end !== false;\n  var delimiter = options.delimiter || DEFAULT_DELIMITER;\n  var endsWith = [].concat(options.endsWith || []).map(escapeString).concat('$').join('|');\n  var route = start ? '^' : ''; // Iterate over the tokens and create our regexp string.\n\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i];\n\n    if (typeof token === 'string') {\n      route += escapeString(token);\n    } else {\n      var capture = token.repeat ? '(?:' + token.pattern + ')(?:' + escapeString(token.delimiter) + '(?:' + token.pattern + '))*' : token.pattern;\n      if (keys) keys.push(token);\n\n      if (token.optional) {\n        if (!token.prefix) {\n          route += '(' + capture + ')?';\n        } else {\n          route += '(?:' + escapeString(token.prefix) + '(' + capture + '))?';\n        }\n      } else {\n        route += escapeString(token.prefix) + '(' + capture + ')';\n      }\n    }\n  }\n\n  if (end) {\n    if (!strict) route += '(?:' + escapeString(delimiter) + ')?';\n    route += endsWith === '$' ? '$' : '(?=' + endsWith + ')';\n  } else {\n    var endToken = tokens[tokens.length - 1];\n    var isEndDelimited = typeof endToken === 'string' ? endToken[endToken.length - 1] === delimiter : endToken === undefined;\n    if (!strict) route += '(?:' + escapeString(delimiter) + '(?=' + endsWith + '))?';\n    if (!isEndDelimited) route += '(?=' + escapeString(delimiter) + '|' + endsWith + ')';\n  }\n\n  return new RegExp(route, flags(options));\n}\n/**\n * Normalize the given path string, returning a regular expression.\n *\n * An empty array can be passed in for the keys, which will hold the\n * placeholder key descriptions. For example, using `/user/:id`, `keys` will\n * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.\n *\n * @param  {(string|RegExp|Array)} path\n * @param  {Array=}                keys\n * @param  {Object=}               options\n * @return {!RegExp}\n */\n\n\nfunction pathToRegexp(path, keys, options) {\n  if (path instanceof RegExp) {\n    return regexpToRegexp(path, keys);\n  }\n\n  if (Array.isArray(path)) {\n    return arrayToRegexp(path, keys, options);\n  }\n\n  return stringToRegexp(path, keys, options);\n}\n\nvar pathToRegexp$1 = pathToRegexp$2.exports;\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar cache = new Map();\n\nfunction decodeParam(val) {\n  try {\n    return decodeURIComponent(val);\n  } catch (err) {\n    return val;\n  }\n}\n\nfunction matchPath(route, pathname, parentKeys, parentParams) {\n  var end = !route.children;\n  var cacheKey = (route.path || '') + \"|\" + end;\n  var regexp = cache.get(cacheKey);\n\n  if (!regexp) {\n    var keys = [];\n    regexp = {\n      keys: keys,\n      pattern: pathToRegexp$1(route.path || '', keys, {\n        end: end\n      })\n    };\n    cache.set(cacheKey, regexp);\n  }\n\n  var m = regexp.pattern.exec(pathname);\n\n  if (!m) {\n    return null;\n  }\n\n  var path = m[0];\n  var params = Object.assign({}, parentParams);\n\n  for (var i = 1; i < m.length; i++) {\n    var key = regexp.keys[i - 1];\n    var prop = key.name;\n    var value = m[i];\n\n    if (value !== undefined || !hasOwnProperty.call(params, prop)) {\n      if (key.repeat) {\n        params[prop] = value ? value.split(key.delimiter).map(decodeParam) : [];\n      } else {\n        params[prop] = value ? decodeParam(value) : value;\n      }\n    }\n  }\n\n  return {\n    path: !end && path.charAt(path.length - 1) === '/' ? path.substr(1) : path,\n    keys: parentKeys.concat(regexp.keys),\n    params: params\n  };\n}\n\nfunction matchRoute(route, baseUrl, pathname, parentKeys, parentParams) {\n  var match;\n  var childMatches;\n  var childIndex = 0;\n  return {\n    next: function next(routeToSkip) {\n      if (route === routeToSkip) {\n        return {\n          done: true\n        };\n      }\n\n      if (!match) {\n        match = matchPath(route, pathname, parentKeys, parentParams);\n\n        if (match) {\n          return {\n            done: false,\n            value: {\n              route: route,\n              baseUrl: baseUrl,\n              path: match.path,\n              keys: match.keys,\n              params: match.params\n            }\n          };\n        }\n      }\n\n      if (match && route.children) {\n        while (childIndex < route.children.length) {\n          if (!childMatches) {\n            var childRoute = route.children[childIndex];\n            childRoute.parent = route;\n            childMatches = matchRoute(childRoute, baseUrl + match.path, pathname.substr(match.path.length), match.keys, match.params);\n          }\n\n          var childMatch = childMatches.next(routeToSkip);\n\n          if (!childMatch.done) {\n            return {\n              done: false,\n              value: childMatch.value\n            };\n          }\n\n          childMatches = null;\n          childIndex++;\n        }\n      }\n\n      return {\n        done: true\n      };\n    }\n  };\n}\n\nfunction resolveRoute(context, params) {\n  if (typeof context.route.action === 'function') {\n    return context.route.action(context, params);\n  }\n\n  return undefined;\n}\n\nfunction isChildRoute(parentRoute, childRoute) {\n  var route = childRoute;\n\n  while (route) {\n    route = route.parent;\n\n    if (route === parentRoute) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nvar UniversalRouter = function () {\n  function UniversalRouter(routes, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (!routes || _typeof__default['default'](routes) !== 'object') {\n      throw new TypeError('Invalid routes');\n    }\n\n    this.baseUrl = options.baseUrl || '';\n    this.errorHandler = options.errorHandler;\n    this.resolveRoute = options.resolveRoute || resolveRoute;\n    this.context = Object.assign({\n      router: this\n    }, options.context);\n    this.root = Array.isArray(routes) ? {\n      path: '',\n      children: routes,\n      parent: null\n    } : routes;\n    this.root.parent = null;\n  }\n\n  var _proto = UniversalRouter.prototype;\n\n  _proto.resolve = function resolve(pathnameOrContext) {\n    var _this = this;\n\n    var context = Object.assign({}, this.context, {}, typeof pathnameOrContext === 'string' ? {\n      pathname: pathnameOrContext\n    } : pathnameOrContext);\n    var match = matchRoute(this.root, this.baseUrl, context.pathname.substr(this.baseUrl.length), [], null);\n    var resolve = this.resolveRoute;\n    var matches = null;\n    var nextMatches = null;\n    var currentContext = context;\n\n    function next(resume, parent, prevResult) {\n      if (parent === void 0) {\n        parent = matches.value.route;\n      }\n\n      var routeToSkip = prevResult === null && !matches.done && matches.value.route;\n      matches = nextMatches || match.next(routeToSkip);\n      nextMatches = null;\n\n      if (!resume) {\n        if (matches.done || !isChildRoute(parent, matches.value.route)) {\n          nextMatches = matches;\n          return Promise.resolve(null);\n        }\n      }\n\n      if (matches.done) {\n        var error = new Error('Route not found');\n        error.status = 404;\n        return Promise.reject(error);\n      }\n\n      currentContext = Object.assign({}, context, {}, matches.value);\n      return Promise.resolve(resolve(currentContext, matches.value.params)).then(function (result) {\n        if (result !== null && result !== undefined) {\n          return result;\n        }\n\n        return next(resume, parent, result);\n      });\n    }\n\n    context.next = next;\n    return Promise.resolve().then(function () {\n      return next(true, _this.root);\n    })[\"catch\"](function (error) {\n      if (_this.errorHandler) {\n        return _this.errorHandler(error, currentContext);\n      }\n\n      throw error;\n    });\n  };\n\n  return UniversalRouter;\n}();\n\nUniversalRouter.pathToRegexp = pathToRegexp$1;\n\nvar queryString = {};\n\nvar strictUriEncode = function strictUriEncode(str) {\n  return encodeURIComponent(str).replace(/[!'()*]/g, function (x) {\n    return \"%\".concat(x.charCodeAt(0).toString(16).toUpperCase());\n  });\n};\n\nvar token = '%[a-f0-9]{2}';\nvar singleMatcher = new RegExp(token, 'gi');\nvar multiMatcher = new RegExp('(' + token + ')+', 'gi');\n\nfunction decodeComponents(components, split) {\n  try {\n    // Try to decode the entire string first\n    return decodeURIComponent(components.join(''));\n  } catch (err) {// Do nothing\n  }\n\n  if (components.length === 1) {\n    return components;\n  }\n\n  split = split || 1; // Split the array in 2 parts\n\n  var left = components.slice(0, split);\n  var right = components.slice(split);\n  return Array.prototype.concat.call([], decodeComponents(left), decodeComponents(right));\n}\n\nfunction decode(input) {\n  try {\n    return decodeURIComponent(input);\n  } catch (err) {\n    var tokens = input.match(singleMatcher);\n\n    for (var i = 1; i < tokens.length; i++) {\n      input = decodeComponents(tokens, i).join('');\n      tokens = input.match(singleMatcher);\n    }\n\n    return input;\n  }\n}\n\nfunction customDecodeURIComponent(input) {\n  // Keep track of all the replacements and prefill the map with the `BOM`\n  var replaceMap = {\n    '%FE%FF': \"\\uFFFD\\uFFFD\",\n    '%FF%FE': \"\\uFFFD\\uFFFD\"\n  };\n  var match = multiMatcher.exec(input);\n\n  while (match) {\n    try {\n      // Decode as big chunks as possible\n      replaceMap[match[0]] = decodeURIComponent(match[0]);\n    } catch (err) {\n      var result = decode(match[0]);\n\n      if (result !== match[0]) {\n        replaceMap[match[0]] = result;\n      }\n    }\n\n    match = multiMatcher.exec(input);\n  } // Add `%C2` at the end of the map to make sure it does not replace the combinator before everything else\n\n\n  replaceMap['%C2'] = \"\\uFFFD\";\n  var entries = Object.keys(replaceMap);\n\n  for (var i = 0; i < entries.length; i++) {\n    // Replace all decoded components\n    var key = entries[i];\n    input = input.replace(new RegExp(key, 'g'), replaceMap[key]);\n  }\n\n  return input;\n}\n\nvar decodeUriComponent = function decodeUriComponent(encodedURI) {\n  if (typeof encodedURI !== 'string') {\n    throw new TypeError('Expected `encodedURI` to be of type `string`, got `' + _typeof__default['default'](encodedURI) + '`');\n  }\n\n  try {\n    encodedURI = encodedURI.replace(/\\+/g, ' '); // Try the built in decoder first\n\n    return decodeURIComponent(encodedURI);\n  } catch (err) {\n    // Fallback to a more advanced decoder\n    return customDecodeURIComponent(encodedURI);\n  }\n};\n\nvar splitOnFirst = function splitOnFirst(string, separator) {\n  if (!(typeof string === 'string' && typeof separator === 'string')) {\n    throw new TypeError('Expected the arguments to be of type `string`');\n  }\n\n  if (separator === '') {\n    return [string];\n  }\n\n  var separatorIndex = string.indexOf(separator);\n\n  if (separatorIndex === -1) {\n    return [string];\n  }\n\n  return [string.slice(0, separatorIndex), string.slice(separatorIndex + separator.length)];\n};\n\nvar filterObj = function filterObj(obj, predicate) {\n  var ret = {};\n  var keys = Object.keys(obj);\n  var isArr = Array.isArray(predicate);\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var val = obj[key];\n\n    if (isArr ? predicate.indexOf(key) !== -1 : predicate(key, val, obj)) {\n      ret[key] = val;\n    }\n  }\n\n  return ret;\n};\n\n(function (exports) {\n\n  var strictUriEncode$1 = strictUriEncode;\n  var decodeComponent = decodeUriComponent;\n  var splitOnFirst$1 = splitOnFirst;\n  var filterObject = filterObj;\n\n  var isNullOrUndefined = function isNullOrUndefined(value) {\n    return value === null || value === undefined;\n  };\n\n  function encoderForArrayFormat(options) {\n    switch (options.arrayFormat) {\n      case 'index':\n        return function (key) {\n          return function (result, value) {\n            var index = result.length;\n\n            if (value === undefined || options.skipNull && value === null || options.skipEmptyString && value === '') {\n              return result;\n            }\n\n            if (value === null) {\n              return [].concat(_toConsumableArray__default['default'](result), [[encode(key, options), '[', index, ']'].join('')]);\n            }\n\n            return [].concat(_toConsumableArray__default['default'](result), [[encode(key, options), '[', encode(index, options), ']=', encode(value, options)].join('')]);\n          };\n        };\n\n      case 'bracket':\n        return function (key) {\n          return function (result, value) {\n            if (value === undefined || options.skipNull && value === null || options.skipEmptyString && value === '') {\n              return result;\n            }\n\n            if (value === null) {\n              return [].concat(_toConsumableArray__default['default'](result), [[encode(key, options), '[]'].join('')]);\n            }\n\n            return [].concat(_toConsumableArray__default['default'](result), [[encode(key, options), '[]=', encode(value, options)].join('')]);\n          };\n        };\n\n      case 'comma':\n      case 'separator':\n        return function (key) {\n          return function (result, value) {\n            if (value === null || value === undefined || value.length === 0) {\n              return result;\n            }\n\n            if (result.length === 0) {\n              return [[encode(key, options), '=', encode(value, options)].join('')];\n            }\n\n            return [[result, encode(value, options)].join(options.arrayFormatSeparator)];\n          };\n        };\n\n      default:\n        return function (key) {\n          return function (result, value) {\n            if (value === undefined || options.skipNull && value === null || options.skipEmptyString && value === '') {\n              return result;\n            }\n\n            if (value === null) {\n              return [].concat(_toConsumableArray__default['default'](result), [encode(key, options)]);\n            }\n\n            return [].concat(_toConsumableArray__default['default'](result), [[encode(key, options), '=', encode(value, options)].join('')]);\n          };\n        };\n    }\n  }\n\n  function parserForArrayFormat(options) {\n    var result;\n\n    switch (options.arrayFormat) {\n      case 'index':\n        return function (key, value, accumulator) {\n          result = /\\[(\\d*)\\]$/.exec(key);\n          key = key.replace(/\\[\\d*\\]$/, '');\n\n          if (!result) {\n            accumulator[key] = value;\n            return;\n          }\n\n          if (accumulator[key] === undefined) {\n            accumulator[key] = {};\n          }\n\n          accumulator[key][result[1]] = value;\n        };\n\n      case 'bracket':\n        return function (key, value, accumulator) {\n          result = /(\\[\\])$/.exec(key);\n          key = key.replace(/\\[\\]$/, '');\n\n          if (!result) {\n            accumulator[key] = value;\n            return;\n          }\n\n          if (accumulator[key] === undefined) {\n            accumulator[key] = [value];\n            return;\n          }\n\n          accumulator[key] = [].concat(accumulator[key], value);\n        };\n\n      case 'comma':\n      case 'separator':\n        return function (key, value, accumulator) {\n          var isArray = typeof value === 'string' && value.includes(options.arrayFormatSeparator);\n          var isEncodedArray = typeof value === 'string' && !isArray && decode(value, options).includes(options.arrayFormatSeparator);\n          value = isEncodedArray ? decode(value, options) : value;\n          var newValue = isArray || isEncodedArray ? value.split(options.arrayFormatSeparator).map(function (item) {\n            return decode(item, options);\n          }) : value === null ? value : decode(value, options);\n          accumulator[key] = newValue;\n        };\n\n      default:\n        return function (key, value, accumulator) {\n          if (accumulator[key] === undefined) {\n            accumulator[key] = value;\n            return;\n          }\n\n          accumulator[key] = [].concat(accumulator[key], value);\n        };\n    }\n  }\n\n  function validateArrayFormatSeparator(value) {\n    if (typeof value !== 'string' || value.length !== 1) {\n      throw new TypeError('arrayFormatSeparator must be single character string');\n    }\n  }\n\n  function encode(value, options) {\n    if (options.encode) {\n      return options.strict ? strictUriEncode$1(value) : encodeURIComponent(value);\n    }\n\n    return value;\n  }\n\n  function decode(value, options) {\n    if (options.decode) {\n      return decodeComponent(value);\n    }\n\n    return value;\n  }\n\n  function keysSorter(input) {\n    if (Array.isArray(input)) {\n      return input.sort();\n    }\n\n    if (_typeof__default['default'](input) === 'object') {\n      return keysSorter(Object.keys(input)).sort(function (a, b) {\n        return Number(a) - Number(b);\n      }).map(function (key) {\n        return input[key];\n      });\n    }\n\n    return input;\n  }\n\n  function removeHash(input) {\n    var hashStart = input.indexOf('#');\n\n    if (hashStart !== -1) {\n      input = input.slice(0, hashStart);\n    }\n\n    return input;\n  }\n\n  function getHash(url) {\n    var hash = '';\n    var hashStart = url.indexOf('#');\n\n    if (hashStart !== -1) {\n      hash = url.slice(hashStart);\n    }\n\n    return hash;\n  }\n\n  function extract(input) {\n    input = removeHash(input);\n    var queryStart = input.indexOf('?');\n\n    if (queryStart === -1) {\n      return '';\n    }\n\n    return input.slice(queryStart + 1);\n  }\n\n  function parseValue(value, options) {\n    if (options.parseNumbers && !Number.isNaN(Number(value)) && typeof value === 'string' && value.trim() !== '') {\n      value = Number(value);\n    } else if (options.parseBooleans && value !== null && (value.toLowerCase() === 'true' || value.toLowerCase() === 'false')) {\n      value = value.toLowerCase() === 'true';\n    }\n\n    return value;\n  }\n\n  function parse(query, options) {\n    options = Object.assign({\n      decode: true,\n      sort: true,\n      arrayFormat: 'none',\n      arrayFormatSeparator: ',',\n      parseNumbers: false,\n      parseBooleans: false\n    }, options);\n    validateArrayFormatSeparator(options.arrayFormatSeparator);\n    var formatter = parserForArrayFormat(options); // Create an object with no prototype\n\n    var ret = Object.create(null);\n\n    if (typeof query !== 'string') {\n      return ret;\n    }\n\n    query = query.trim().replace(/^[?#&]/, '');\n\n    if (!query) {\n      return ret;\n    }\n\n    var _iterator = _createForOfIteratorHelper__default['default'](query.split('&')),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var param = _step.value;\n\n        if (param === '') {\n          continue;\n        }\n\n        var _splitOnFirst = splitOnFirst$1(options.decode ? param.replace(/\\+/g, ' ') : param, '='),\n            _splitOnFirst2 = _slicedToArray__default['default'](_splitOnFirst, 2),\n            _key = _splitOnFirst2[0],\n            _value = _splitOnFirst2[1]; // Missing `=` should be `null`:\n        // http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n\n\n        _value = _value === undefined ? null : ['comma', 'separator'].includes(options.arrayFormat) ? _value : decode(_value, options);\n        formatter(decode(_key, options), _value, ret);\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    for (var _i = 0, _Object$keys = Object.keys(ret); _i < _Object$keys.length; _i++) {\n      var key = _Object$keys[_i];\n      var value = ret[key];\n\n      if (_typeof__default['default'](value) === 'object' && value !== null) {\n        for (var _i2 = 0, _Object$keys2 = Object.keys(value); _i2 < _Object$keys2.length; _i2++) {\n          var k = _Object$keys2[_i2];\n          value[k] = parseValue(value[k], options);\n        }\n      } else {\n        ret[key] = parseValue(value, options);\n      }\n    }\n\n    if (options.sort === false) {\n      return ret;\n    }\n\n    return (options.sort === true ? Object.keys(ret).sort() : Object.keys(ret).sort(options.sort)).reduce(function (result, key) {\n      var value = ret[key];\n\n      if (Boolean(value) && _typeof__default['default'](value) === 'object' && !Array.isArray(value)) {\n        // Sort object keys, not values\n        result[key] = keysSorter(value);\n      } else {\n        result[key] = value;\n      }\n\n      return result;\n    }, Object.create(null));\n  }\n\n  exports.extract = extract;\n  exports.parse = parse;\n\n  exports.stringify = function (object, options) {\n    if (!object) {\n      return '';\n    }\n\n    options = Object.assign({\n      encode: true,\n      strict: true,\n      arrayFormat: 'none',\n      arrayFormatSeparator: ','\n    }, options);\n    validateArrayFormatSeparator(options.arrayFormatSeparator);\n\n    var shouldFilter = function shouldFilter(key) {\n      return options.skipNull && isNullOrUndefined(object[key]) || options.skipEmptyString && object[key] === '';\n    };\n\n    var formatter = encoderForArrayFormat(options);\n    var objectCopy = {};\n\n    for (var _i3 = 0, _Object$keys3 = Object.keys(object); _i3 < _Object$keys3.length; _i3++) {\n      var key = _Object$keys3[_i3];\n\n      if (!shouldFilter(key)) {\n        objectCopy[key] = object[key];\n      }\n    }\n\n    var keys = Object.keys(objectCopy);\n\n    if (options.sort !== false) {\n      keys.sort(options.sort);\n    }\n\n    return keys.map(function (key) {\n      var value = object[key];\n\n      if (value === undefined) {\n        return '';\n      }\n\n      if (value === null) {\n        return encode(key, options);\n      }\n\n      if (Array.isArray(value)) {\n        return value.reduce(formatter(key), []).join('&');\n      }\n\n      return encode(key, options) + '=' + encode(value, options);\n    }).filter(function (x) {\n      return x.length > 0;\n    }).join('&');\n  };\n\n  exports.parseUrl = function (url, options) {\n    options = Object.assign({\n      decode: true\n    }, options);\n\n    var _splitOnFirst3 = splitOnFirst$1(url, '#'),\n        _splitOnFirst4 = _slicedToArray__default['default'](_splitOnFirst3, 2),\n        url_ = _splitOnFirst4[0],\n        hash = _splitOnFirst4[1];\n\n    return Object.assign({\n      url: url_.split('?')[0] || '',\n      query: parse(extract(url), options)\n    }, options && options.parseFragmentIdentifier && hash ? {\n      fragmentIdentifier: decode(hash, options)\n    } : {});\n  };\n\n  exports.stringifyUrl = function (object, options) {\n    options = Object.assign({\n      encode: true,\n      strict: true\n    }, options);\n    var url = removeHash(object.url).split('?')[0] || '';\n    var queryFromUrl = exports.extract(object.url);\n    var parsedQueryFromUrl = exports.parse(queryFromUrl, {\n      sort: false\n    });\n    var query = Object.assign(parsedQueryFromUrl, object.query);\n    var queryString = exports.stringify(query, options);\n\n    if (queryString) {\n      queryString = \"?\".concat(queryString);\n    }\n\n    var hash = getHash(object.url);\n\n    if (object.fragmentIdentifier) {\n      hash = \"#\".concat(encode(object.fragmentIdentifier, options));\n    }\n\n    return \"\".concat(url).concat(queryString).concat(hash);\n  };\n\n  exports.pick = function (input, filter, options) {\n    options = Object.assign({\n      parseFragmentIdentifier: true\n    }, options);\n\n    var _exports$parseUrl = exports.parseUrl(input, options),\n        url = _exports$parseUrl.url,\n        query = _exports$parseUrl.query,\n        fragmentIdentifier = _exports$parseUrl.fragmentIdentifier;\n\n    return exports.stringifyUrl({\n      url: url,\n      query: filterObject(query, filter),\n      fragmentIdentifier: fragmentIdentifier\n    }, options);\n  };\n\n  exports.exclude = function (input, filter, options) {\n    var exclusionFilter = Array.isArray(filter) ? function (key) {\n      return !filter.includes(key);\n    } : function (key, value) {\n      return !filter(key, value);\n    };\n    return exports.pick(input, exclusionFilter, options);\n  };\n})(queryString);\n\n/**\r\n * 插入页面动画需要的样式\r\n */\nfunction loadAnimateStyle() {\n  var ms = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 300;\n  var css = \"\\n.taro_router .taro_page {\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  width: 100%;\\n  height: 100%;\\n  background-color: #fff;\\n  transform: translate(100%, 0);\\n  transition: transform \".concat(ms, \"ms;\\n  z-index: 0;\\n}\\n\\n.taro_router .taro_page.taro_tabbar_page,\\n.taro_router .taro_page.taro_page_show.taro_page_stationed {\\n  transform: none;\\n}\\n\\n.taro_router .taro_page.taro_page_show {\\n  transform: translate(0, 0);\\n}\");\n  var style = document.createElement('style');\n  style.innerHTML = css;\n  document.getElementsByTagName('head')[0].appendChild(style);\n}\n\n// @ts-nocheck\nfunction initTabbar(config) {\n  if (config.tabBar == null) {\n    return;\n  } // TODO: custom-tab-bar\n\n\n  var tabbar = document.createElement('taro-tabbar');\n  var homePage = config.entryPagePath || (config.pages ? config.pages[0] : '');\n  tabbar.conf = config.tabBar;\n  tabbar.conf.homePage = exports.history.location.pathname === '/' ? homePage : exports.history.location.pathname;\n  var routerConfig = config.router;\n  tabbar.conf.mode = routerConfig && routerConfig.mode ? routerConfig.mode : 'hash';\n\n  if (routerConfig.customRoutes) {\n    tabbar.conf.custom = true;\n    tabbar.conf.customRoutes = routerConfig.customRoutes;\n  } else {\n    tabbar.conf.custom = false;\n    tabbar.conf.customRoutes = {};\n  }\n\n  if (typeof routerConfig.basename !== 'undefined') {\n    tabbar.conf.basename = routerConfig.basename;\n  }\n\n  var container = document.getElementById('container');\n  container === null || container === void 0 ? void 0 : container.appendChild(tabbar);\n  taro.initTabBarApis(config);\n}\n\nvar pageResizeFn;\nfunction bindPageResize(page) {\n  window.removeEventListener('resize', pageResizeFn);\n\n  pageResizeFn = function pageResizeFn() {\n    page.onResize && page.onResize({\n      size: {\n        windowHeight: window.innerHeight,\n        windowWidth: window.innerWidth\n      }\n    });\n  };\n\n  window.addEventListener('resize', pageResizeFn, false);\n}\n\nvar pageScrollFn;\nvar pageDOM = window;\nfunction bindPageScroll(page, pageEl) {\n  var distance = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 50;\n  pageEl.removeEventListener('scroll', pageScrollFn);\n  pageDOM = pageEl;\n  var isReachBottom = false;\n\n  pageScrollFn = function pageScrollFn() {\n    page.onPageScroll && page.onPageScroll({\n      scrollTop: pageDOM instanceof Window ? window.scrollY : pageDOM.scrollTop\n    });\n\n    if (isReachBottom && getOffset() > distance) {\n      isReachBottom = false;\n    }\n\n    if (page.onReachBottom && !isReachBottom && getOffset() < distance) {\n      isReachBottom = true;\n      page.onReachBottom();\n    }\n  };\n\n  pageDOM.addEventListener('scroll', pageScrollFn, false);\n}\n\nfunction getOffset() {\n  if (pageDOM instanceof Window) {\n    return document.documentElement.scrollHeight - window.scrollY - window.innerHeight;\n  } else {\n    return pageDOM.scrollHeight - pageDOM.scrollTop - pageDOM.clientHeight;\n  }\n}\n\nfunction setDisplay(el) {\n  var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n\n  if (el) {\n    el.style.display = type;\n  }\n}\n\nvar PageHandler = /*#__PURE__*/function () {\n  function PageHandler(config) {\n    _classCallCheck__default['default'](this, PageHandler);\n\n    _defineProperty__default['default'](this, \"config\", void 0);\n\n    _defineProperty__default['default'](this, \"defaultAnimation\", {\n      duration: 300,\n      delay: 50\n    });\n\n    _defineProperty__default['default'](this, \"unloadTimer\", void 0);\n\n    _defineProperty__default['default'](this, \"hideTimer\", void 0);\n\n    _defineProperty__default['default'](this, \"lastHidePage\", void 0);\n\n    _defineProperty__default['default'](this, \"lastUnloadPage\", void 0);\n\n    this.config = config;\n    this.mount();\n  }\n\n  _createClass__default['default'](PageHandler, [{\n    key: \"appId\",\n    get: function get() {\n      return 'app';\n    }\n  }, {\n    key: \"router\",\n    get: function get() {\n      return this.config.router;\n    }\n  }, {\n    key: \"routerMode\",\n    get: function get() {\n      return this.router.mode || 'hash';\n    }\n  }, {\n    key: \"customRoutes\",\n    get: function get() {\n      return this.router.customRoutes || {};\n    }\n  }, {\n    key: \"routes\",\n    get: function get() {\n      return this.config.routes;\n    }\n  }, {\n    key: \"tabBarList\",\n    get: function get() {\n      var _this$config$tabBar;\n\n      return ((_this$config$tabBar = this.config.tabBar) === null || _this$config$tabBar === void 0 ? void 0 : _this$config$tabBar.list) || [];\n    }\n  }, {\n    key: \"PullDownRefresh\",\n    get: function get() {\n      return this.config.PullDownRefresh;\n    }\n  }, {\n    key: \"animation\",\n    get: function get() {\n      var _this$config$animatio, _this$config;\n\n      return (_this$config$animatio = (_this$config = this.config) === null || _this$config === void 0 ? void 0 : _this$config.animation) !== null && _this$config$animatio !== void 0 ? _this$config$animatio : this.defaultAnimation;\n    }\n  }, {\n    key: \"animationDelay\",\n    get: function get() {\n      var _this$defaultAnimatio;\n\n      return (_typeof__default['default'](this.animation) === 'object' ? this.animation.delay : this.animation ? (_this$defaultAnimatio = this.defaultAnimation) === null || _this$defaultAnimatio === void 0 ? void 0 : _this$defaultAnimatio.delay : 0) || 0;\n    }\n  }, {\n    key: \"animationDuration\",\n    get: function get() {\n      var _this$defaultAnimatio2;\n\n      return (_typeof__default['default'](this.animation) === 'object' ? this.animation.duration : this.animation ? (_this$defaultAnimatio2 = this.defaultAnimation) === null || _this$defaultAnimatio2 === void 0 ? void 0 : _this$defaultAnimatio2.duration : 0) || 0;\n    }\n  }, {\n    key: \"pathname\",\n    get: function get() {\n      return this.router.pathname;\n    },\n    set: function set(p) {\n      this.router.pathname = p;\n    }\n  }, {\n    key: \"basename\",\n    get: function get() {\n      return this.router.basename || '';\n    }\n  }, {\n    key: \"pageConfig\",\n    get: function get() {\n      var _this = this;\n\n      return this.routes.find(function (r) {\n        var _routesAlias$getConfi;\n\n        var routePath = stripBasename(_this.pathname, _this.basename);\n        var pagePath = addLeadingSlash(r.path);\n        return pagePath === routePath || ((_routesAlias$getConfi = routesAlias.getConfig(pagePath)) === null || _routesAlias$getConfi === void 0 ? void 0 : _routesAlias$getConfi.includes(routePath));\n      });\n    }\n  }, {\n    key: \"isTabBar\",\n    get: function get() {\n      var _Object$entries$find;\n\n      var routePath = stripBasename(this.pathname, this.basename);\n      var pagePath = ((_Object$entries$find = Object.entries(this.customRoutes).find(function (_ref) {\n        var _ref2 = _slicedToArray__default['default'](_ref, 2),\n            target = _ref2[1];\n\n        if (typeof target === 'string') {\n          return target === routePath;\n        } else if ((target === null || target === void 0 ? void 0 : target.length) > 0) {\n          return target.includes(routePath);\n        }\n\n        return false;\n      })) === null || _Object$entries$find === void 0 ? void 0 : _Object$entries$find[0]) || routePath;\n      return !!pagePath && this.tabBarList.some(function (t) {\n        return t.pagePath === pagePath;\n      });\n    }\n  }, {\n    key: \"isSamePage\",\n    value: function isSamePage(page) {\n      var routePath = stripBasename(this.pathname, this.basename);\n      var pagePath = stripBasename(page === null || page === void 0 ? void 0 : page.path, this.basename);\n      return pagePath.startsWith(routePath + '?');\n    }\n  }, {\n    key: \"search\",\n    get: function get() {\n      var search = '?';\n\n      if (this.routerMode === 'hash') {\n        var idx = location.hash.indexOf('?');\n\n        if (idx > -1) {\n          search = location.hash.slice(idx);\n        }\n      } else {\n        search = location.search;\n      }\n\n      return search.substr(1);\n    }\n  }, {\n    key: \"getQuery\",\n    value: function getQuery() {\n      var stamp = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      var search = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      search = search ? \"\".concat(search, \"&\").concat(this.search) : this.search;\n      var query = search ? queryString.parse(search, {\n        decode: false\n      }) : {};\n      query.stamp = stamp.toString();\n      return _objectSpread__default['default'](_objectSpread__default['default']({}, query), options);\n    }\n  }, {\n    key: \"mount\",\n    value: function mount() {\n      var _document$getElementB;\n\n      setHistoryMode(this.routerMode, this.router.basename);\n      (_document$getElementB = document.getElementById('app')) === null || _document$getElementB === void 0 ? void 0 : _document$getElementB.remove();\n      this.animation && loadAnimateStyle(this.animationDuration);\n      var app = document.createElement('div');\n      app.id = this.appId;\n      app.classList.add('taro_router');\n\n      if (this.tabBarList.length > 1) {\n        var container = document.createElement('div');\n        container.classList.add('taro-tabbar__container');\n        container.id = 'container';\n        var panel = document.createElement('div');\n        panel.classList.add('taro-tabbar__panel');\n        panel.appendChild(app);\n        container.appendChild(panel);\n        document.body.appendChild(container);\n        initTabbar(this.config);\n      } else {\n        document.body.appendChild(app);\n      }\n    }\n  }, {\n    key: \"onReady\",\n    value: function onReady(page) {\n      var onLoad = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      var pageEl = this.getPageContainer(page);\n\n      if (pageEl && !(pageEl !== null && pageEl !== void 0 && pageEl['__isReady'])) {\n        var _el$componentOnReady, _el$componentOnReady$;\n\n        var el = pageEl.firstElementChild;\n        el === null || el === void 0 ? void 0 : (_el$componentOnReady = el['componentOnReady']) === null || _el$componentOnReady === void 0 ? void 0 : (_el$componentOnReady$ = _el$componentOnReady.call(el)) === null || _el$componentOnReady$ === void 0 ? void 0 : _el$componentOnReady$.then(function () {\n          runtime.requestAnimationFrame(function () {\n            var _page$onReady;\n\n            (_page$onReady = page.onReady) === null || _page$onReady === void 0 ? void 0 : _page$onReady.call(page);\n            pageEl['__isReady'] = true;\n          });\n        });\n        onLoad && (pageEl['__page'] = page);\n      }\n    }\n  }, {\n    key: \"load\",\n    value: function load(page) {\n      var _this2 = this;\n\n      var pageConfig = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var stacksIndex = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      if (!page) return; // NOTE: 页面栈推入太晚可能导致 getCurrentPages 无法获取到当前页面实例\n\n      stacks.push(page);\n      var param = this.getQuery(stacks.length, '', page.options);\n      var pageEl = this.getPageContainer(page);\n\n      if (pageEl) {\n        var _page$onShow;\n\n        setDisplay(pageEl);\n        this.isTabBar && pageEl.classList.add('taro_tabbar_page');\n        this.addAnimation(pageEl, stacksIndex === 0);\n        (_page$onShow = page.onShow) === null || _page$onShow === void 0 ? void 0 : _page$onShow.call(page);\n        this.bindPageEvents(page, pageEl, pageConfig);\n      } else {\n        var _page$onLoad;\n\n        (_page$onLoad = page.onLoad) === null || _page$onLoad === void 0 ? void 0 : _page$onLoad.call(page, param, function () {\n          var _pageEl, _page$onShow2;\n\n          pageEl = _this2.getPageContainer(page);\n          _this2.isTabBar && ((_pageEl = pageEl) === null || _pageEl === void 0 ? void 0 : _pageEl.classList.add('taro_tabbar_page'));\n\n          _this2.addAnimation(pageEl, stacksIndex === 0);\n\n          _this2.onReady(page, true);\n\n          (_page$onShow2 = page.onShow) === null || _page$onShow2 === void 0 ? void 0 : _page$onShow2.call(page);\n\n          _this2.bindPageEvents(page, pageEl, pageConfig);\n        });\n      }\n    }\n  }, {\n    key: \"unload\",\n    value: function unload(page) {\n      var _this3 = this;\n\n      var delta = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n      var top = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      if (!page) return;\n      stacks.delta = --delta;\n      stacks.pop();\n\n      if (this.animation && top) {\n        if (this.unloadTimer) {\n          var _this$lastUnloadPage, _this$lastUnloadPage$;\n\n          clearTimeout(this.unloadTimer);\n          (_this$lastUnloadPage = this.lastUnloadPage) === null || _this$lastUnloadPage === void 0 ? void 0 : (_this$lastUnloadPage$ = _this$lastUnloadPage.onUnload) === null || _this$lastUnloadPage$ === void 0 ? void 0 : _this$lastUnloadPage$.call(_this$lastUnloadPage);\n          this.unloadTimer = null;\n        }\n\n        this.lastUnloadPage = page;\n        var pageEl = this.getPageContainer(page);\n        pageEl === null || pageEl === void 0 ? void 0 : pageEl.classList.remove('taro_page_stationed');\n        pageEl === null || pageEl === void 0 ? void 0 : pageEl.classList.remove('taro_page_show');\n        this.unloadTimer = setTimeout(function () {\n          var _this3$lastUnloadPage, _this3$lastUnloadPage2;\n\n          _this3.unloadTimer = null;\n          (_this3$lastUnloadPage = _this3.lastUnloadPage) === null || _this3$lastUnloadPage === void 0 ? void 0 : (_this3$lastUnloadPage2 = _this3$lastUnloadPage.onUnload) === null || _this3$lastUnloadPage2 === void 0 ? void 0 : _this3$lastUnloadPage2.call(_this3$lastUnloadPage);\n        }, this.animationDuration);\n      } else {\n        var _page$onUnload;\n\n        var _pageEl2 = this.getPageContainer(page);\n\n        _pageEl2 === null || _pageEl2 === void 0 ? void 0 : _pageEl2.classList.remove('taro_page_stationed');\n        _pageEl2 === null || _pageEl2 === void 0 ? void 0 : _pageEl2.classList.remove('taro_page_show');\n        page === null || page === void 0 ? void 0 : (_page$onUnload = page.onUnload) === null || _page$onUnload === void 0 ? void 0 : _page$onUnload.call(page);\n      }\n\n      if (delta >= 1) this.unload(stacks.last, delta);\n    }\n  }, {\n    key: \"show\",\n    value: function show(page) {\n      var _this4 = this;\n\n      var pageConfig = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var stacksIndex = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      if (!page) return;\n      var param = this.getQuery(stacks.length, '', page.options);\n      var pageEl = this.getPageContainer(page);\n\n      if (pageEl) {\n        var _page$onShow3;\n\n        setDisplay(pageEl);\n        this.addAnimation(pageEl, stacksIndex === 0);\n        (_page$onShow3 = page.onShow) === null || _page$onShow3 === void 0 ? void 0 : _page$onShow3.call(page);\n        this.bindPageEvents(page, pageEl, pageConfig);\n      } else {\n        var _page$onLoad2;\n\n        (_page$onLoad2 = page.onLoad) === null || _page$onLoad2 === void 0 ? void 0 : _page$onLoad2.call(page, param, function () {\n          var _page$onShow4;\n\n          pageEl = _this4.getPageContainer(page);\n\n          _this4.addAnimation(pageEl, stacksIndex === 0);\n\n          _this4.onReady(page, false);\n\n          (_page$onShow4 = page.onShow) === null || _page$onShow4 === void 0 ? void 0 : _page$onShow4.call(page);\n\n          _this4.bindPageEvents(page, pageEl, pageConfig);\n        });\n      }\n    }\n  }, {\n    key: \"hide\",\n    value: function hide(page) {\n      var _this5 = this;\n\n      if (!page) return; // NOTE: 修复多页并发问题，此处可能因为路由跳转过快，执行时页面可能还没有创建成功\n\n      var pageEl = this.getPageContainer(page);\n\n      if (pageEl) {\n        var _page$onHide;\n\n        if (this.hideTimer) {\n          clearTimeout(this.hideTimer);\n          this.hideTimer = null;\n          setDisplay(this.lastHidePage, 'none');\n        }\n\n        this.lastHidePage = pageEl;\n        this.hideTimer = setTimeout(function () {\n          _this5.hideTimer = null;\n          setDisplay(_this5.lastHidePage, 'none');\n        }, this.animationDuration + this.animationDelay);\n        (_page$onHide = page.onHide) === null || _page$onHide === void 0 ? void 0 : _page$onHide.call(page);\n      } else {\n        setTimeout(function () {\n          return _this5.hide(page);\n        }, 0);\n      }\n    }\n  }, {\n    key: \"addAnimation\",\n    value: function addAnimation(pageEl) {\n      var _this6 = this;\n\n      var first = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      if (!pageEl) return;\n\n      if (this.animation && !first) {\n        setTimeout(function () {\n          pageEl.classList.add('taro_page_show');\n          setTimeout(function () {\n            pageEl.classList.add('taro_page_stationed');\n          }, _this6.animationDuration);\n        }, this.animationDelay);\n      } else {\n        pageEl.classList.add('taro_page_show');\n        pageEl.classList.add('taro_page_stationed');\n      }\n    }\n  }, {\n    key: \"getPageContainer\",\n    value: function getPageContainer(page) {\n      var _Current$page;\n\n      var path = page ? page === null || page === void 0 ? void 0 : page.path : (_Current$page = runtime.Current.page) === null || _Current$page === void 0 ? void 0 : _Current$page.path;\n      var id = path === null || path === void 0 ? void 0 : path.replace(/([^a-z0-9\\u00a0-\\uffff_-])/ig, '\\\\$1');\n\n      if (page) {\n        return document.querySelector(\".taro_page#\".concat(id));\n      }\n\n      var el = id ? document.querySelector(\".taro_page#\".concat(id)) : document.querySelector('.taro_page') || document.querySelector('.taro_router');\n      return el || window;\n    }\n  }, {\n    key: \"bindPageEvents\",\n    value: function bindPageEvents(page, pageEl) {\n      var _this$config$window;\n\n      var config = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      if (!pageEl) {\n        pageEl = this.getPageContainer();\n      }\n\n      var distance = config.onReachBottomDistance || ((_this$config$window = this.config.window) === null || _this$config$window === void 0 ? void 0 : _this$config$window.onReachBottomDistance) || 50;\n      bindPageScroll(page, pageEl, distance);\n      bindPageResize(page);\n    }\n  }]);\n\n  return PageHandler;\n}();\n\nfunction createRouter(app, config, framework) {\n  var _routes$0$path, _app$onLaunch, _app$onShow;\n\n  var handler = new PageHandler(config);\n  var runtimeHooks = runtime.container.get(runtime.SERVICE_IDENTIFIER.Hooks);\n  routesAlias.set(handler.router.customRoutes);\n  var basename = handler.router.basename;\n  var routes = handler.routes.map(function (route) {\n    return {\n      path: routesAlias.getAll(addLeadingSlash(route.path)),\n      action: route.load\n    };\n  });\n  var entryPagePath = config.entryPagePath || ((_routes$0$path = routes[0].path) === null || _routes$0$path === void 0 ? void 0 : _routes$0$path[0]);\n  var router = new UniversalRouter(routes, {\n    baseUrl: basename || ''\n  });\n  var launchParam = handler.getQuery(stacks.length);\n  (_app$onLaunch = app.onLaunch) === null || _app$onLaunch === void 0 ? void 0 : _app$onLaunch.call(app, launchParam);\n\n  var render = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator__default['default']( /*#__PURE__*/_regeneratorRuntime__default['default'].mark(function _callee(_ref) {\n      var _config$window;\n\n      var location, action, element, _app$onPageNotFound, pageConfig, enablePullDownRefresh, _pageConfig$navigatio, currentPage, pathname, shouldLoad, prevIndex, delta, _prevIndex, _delta, _element$default, _runtimeHooks$createP, el, loadConfig, stacksIndex, page;\n\n      return _regeneratorRuntime__default['default'].wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              location = _ref.location, action = _ref.action;\n              handler.pathname = location.pathname;\n              _context.prev = 2;\n              _context.next = 5;\n              return router.resolve(handler.router.forcePath || handler.pathname);\n\n            case 5:\n              element = _context.sent;\n              _context.next = 15;\n              break;\n\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](2);\n\n              if (!(_context.t0.status === 404)) {\n                _context.next = 14;\n                break;\n              }\n\n              (_app$onPageNotFound = app.onPageNotFound) === null || _app$onPageNotFound === void 0 ? void 0 : _app$onPageNotFound.call(app, {\n                path: handler.pathname\n              });\n              _context.next = 15;\n              break;\n\n            case 14:\n              throw new Error(_context.t0);\n\n            case 15:\n              if (element) {\n                _context.next = 17;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 17:\n              pageConfig = handler.pageConfig;\n              enablePullDownRefresh = (config === null || config === void 0 ? void 0 : (_config$window = config.window) === null || _config$window === void 0 ? void 0 : _config$window.enablePullDownRefresh) || false;\n              runtime.eventCenter.trigger('__taroRouterChange', {\n                toLocation: {\n                  path: handler.pathname\n                }\n              });\n\n              if (pageConfig) {\n                document.title = (_pageConfig$navigatio = pageConfig.navigationBarTitleText) !== null && _pageConfig$navigatio !== void 0 ? _pageConfig$navigatio : document.title;\n\n                if (typeof pageConfig.enablePullDownRefresh === 'boolean') {\n                  enablePullDownRefresh = pageConfig.enablePullDownRefresh;\n                }\n              }\n\n              currentPage = runtime.Current.page;\n              pathname = handler.pathname;\n              shouldLoad = false;\n\n              if (!(action === 'POP')) {\n                _context.next = 31;\n                break;\n              }\n\n              // NOTE: 浏览器事件退后多次时，该事件只会被触发一次\n              prevIndex = stacks.getPrevIndex(pathname);\n              delta = stacks.getDelta(pathname);\n              handler.unload(currentPage, delta, prevIndex > -1);\n\n              if (prevIndex > -1) {\n                handler.show(stacks.getItem(prevIndex), pageConfig, prevIndex);\n              } else {\n                shouldLoad = true;\n              }\n\n              _context.next = 42;\n              break;\n\n            case 31:\n              if (!handler.isTabBar) {\n                _context.next = 40;\n                break;\n              }\n\n              if (!handler.isSamePage(currentPage)) {\n                _context.next = 34;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 34:\n              _prevIndex = stacks.getPrevIndex(pathname, 0);\n              handler.hide(currentPage);\n\n              if (!(_prevIndex > -1)) {\n                _context.next = 38;\n                break;\n              }\n\n              return _context.abrupt(\"return\", handler.show(stacks.getItem(_prevIndex), pageConfig, _prevIndex));\n\n            case 38:\n              _context.next = 41;\n              break;\n\n            case 40:\n              if (action === 'REPLACE') {\n                _delta = stacks.getDelta(pathname); // NOTE: 页面路由记录并不会清空，只是移除掉缓存的 stack 以及页面\n\n                handler.unload(currentPage, _delta);\n              } else if (action === 'PUSH') {\n                handler.hide(currentPage);\n              }\n\n            case 41:\n              shouldLoad = true;\n\n            case 42:\n              if (!(shouldLoad || stacks.length < 1)) {\n                _context.next = 50;\n                break;\n              }\n\n              el = (_element$default = element.default) !== null && _element$default !== void 0 ? _element$default : element;\n              loadConfig = _objectSpread__default['default']({}, pageConfig);\n              stacksIndex = stacks.length;\n              delete loadConfig['path'];\n              delete loadConfig['load'];\n              page = runtime.createPageConfig(enablePullDownRefresh ? (_runtimeHooks$createP = runtimeHooks.createPullDownComponent) === null || _runtimeHooks$createP === void 0 ? void 0 : _runtimeHooks$createP.call(runtimeHooks, el, location.pathname, framework, handler.PullDownRefresh) : el, pathname + runtime.stringify(handler.getQuery(stacksIndex)), {}, loadConfig);\n              return _context.abrupt(\"return\", handler.load(page, pageConfig, stacksIndex));\n\n            case 50:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 8]]);\n    }));\n\n    return function render(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  if (exports.history.location.pathname === '/') {\n    exports.history.replace(prependBasename(entryPagePath + exports.history.location.search));\n  }\n\n  render({\n    location: exports.history.location,\n    action: r.Push\n  });\n  (_app$onShow = app.onShow) === null || _app$onShow === void 0 ? void 0 : _app$onShow.call(app, launchParam);\n  return exports.history.listen(render);\n}\n\nexports.createRouter = createRouter;\nexports.getCurrentPages = getCurrentPages;\nexports.navigateBack = navigateBack;\nexports.navigateTo = navigateTo;\nexports.reLaunch = reLaunch;\nexports.redirectTo = redirectTo;\nexports.switchTab = switchTab;\n//# sourceMappingURL=index.js.map\n"]}